{"componentChunkName":"component---src-templates-page-tsx","path":"/time-machine-on-linux/","result":{"data":{"site":{"siteMetadata":{"title":"Elsa Granger","description":"Elsa Granger Personal Page","author":{"name":"","url":""}}},"markdownRemark":{"html":"<p>在 Linux 上配置了 Samba 之后，并不能字节用来作为 Time Machine 的备份分区，在 Finder 的 Network 下，直接尝试 Connect As 并不能够连上服务器，只能通过 <code class=\"language-text\">cmd + k</code> 连接上去。都是用于没有配置 afp 协议。</p>\n<h2>Installation</h2>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">apt</span> <span class=\"token function\">install</span> netatalk avahi-daemon</code></pre></div>\n<h2>Configure</h2>\n<h3>netatalk</h3>\n<p>位置 <code class=\"language-text\">/etc/netatalk/afp.conf</code></p>\n<div class=\"gatsby-highlight\" data-language=\"conf\"><pre class=\"language-conf\"><code class=\"language-conf\">[Global]\n dbus daemon = /usr/bin/dbus-daemon\n disconnect time = 3\n sleep time = 2\n log file = /var/log/netatalk.log\n log level = default:info\n uam list = uams_dhx2.so\n zeroconf = yes\n save password = no\n\n\n[SharedFolder]\n path = &#39;shared folder path&#39;\n ; http://netatalk.sourceforge.net/wiki/index.php/Spotlight\n ; spotlight = yes\n valid users = USERNAME1 USERNAME2 USERNAME3\n unix priv = yes\n file perm = 0600\n\n[TimeCapsule]\npath = &#39;time machine folder&#39;\nvalid users = USERNAME2\ntime machine = yes\nunix priv = yes\nfile perm = 0600</code></pre></div>\n<h3>avahi</h3>\n<p>添加 afp 协议 </p>\n<p>位置 <code class=\"language-text\">/etc/avahi/services/timecapsule_afpd.service</code></p>\n<div class=\"gatsby-highlight\" data-language=\"xml\"><pre class=\"language-xml\"><code class=\"language-xml\"><span class=\"token prolog\">&lt;?xml version=\"1.0\" standalone='no'?></span>\n<span class=\"token doctype\"><span class=\"token punctuation\">&lt;!</span><span class=\"token doctype-tag\">DOCTYPE</span> <span class=\"token name\">service-group</span> <span class=\"token name\">SYSTEM</span> <span class=\"token string\">\"avahi-service.dtd\"</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>service-group</span><span class=\"token punctuation\">></span></span>\n <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span> <span class=\"token attr-name\">replace-wildcards</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>yes<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>%h<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span>\n <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>service</span><span class=\"token punctuation\">></span></span>\n <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>type</span><span class=\"token punctuation\">></span></span>_afpovertcp._tcp<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>type</span><span class=\"token punctuation\">></span></span>\n <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>port</span><span class=\"token punctuation\">></span></span>548<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>port</span><span class=\"token punctuation\">></span></span>\n <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>service</span><span class=\"token punctuation\">></span></span>\n <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>service</span><span class=\"token punctuation\">></span></span>\n <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>type</span><span class=\"token punctuation\">></span></span>_device-info._tcp<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>type</span><span class=\"token punctuation\">></span></span>\n <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>port</span><span class=\"token punctuation\">></span></span>0<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>port</span><span class=\"token punctuation\">></span></span>\n <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>txt-record</span><span class=\"token punctuation\">></span></span>model=TimeCapsule<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>txt-record</span><span class=\"token punctuation\">></span></span>\n <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>service</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>service-group</span><span class=\"token punctuation\">></span></span></code></pre></div>","excerpt":"在 Linux 上配置了 Samba 之后，并不能字节用来作为 Time Machine 的备份分区，在 Finder 的 Network 下，直接尝试 Connect As 并不能够连上服务器，只能通过  连接上去。都是用于没有配置 afp 协议。 Installation…","frontmatter":{"title":"Time Machine Server on Linux"}}},"pageContext":{"slug":"/time-machine-on-linux/"}},"staticQueryHashes":[]}