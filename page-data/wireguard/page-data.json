{"componentChunkName":"component---node-modules-narative-gatsby-theme-novela-src-templates-article-template-tsx","path":"/wireguard","result":{"pageContext":{"article":{"id":"930818d7-5a80-5fce-ad59-d9fab7b64895","slug":"/wireguard","secret":false,"title":"WireGuard 配置","author":"Elsa Granger","date":"March 26th, 2021","dateForSEO":"2021-03-26T00:00:00.000Z","timeToRead":1,"excerpt":"Installation 比较新的内核都已经将 WireGuard 打包进了内核，直接安装管理工具即可 查看是否安装完成 在  /etc/moduels  后追加  wireguard  使得能够自动载入内核模块 Config 生成公私钥 Peer…","canonical_url":null,"subscription":true,"body":"function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"WireGuard 配置\",\n  \"author\": \"Elsa Granger\",\n  \"hero\": \"./images/wireguard-hero.png\",\n  \"date\": \"2021-03-26T00:00:00.000Z\",\n  \"excerpt\": \"\"\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, [\"components\"]);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"h2\", {\n    \"id\": \"installation\"\n  }, \"Installation\"), mdx(\"p\", null, \"\\u6BD4\\u8F83\\u65B0\\u7684\\u5185\\u6838\\u90FD\\u5DF2\\u7ECF\\u5C06 WireGuard \\u6253\\u5305\\u8FDB\\u4E86\\u5185\\u6838\\uFF0C\\u76F4\\u63A5\\u5B89\\u88C5\\u7BA1\\u7406\\u5DE5\\u5177\\u5373\\u53EF\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-shell\"\n  }, \"sudo apt install wireguard\\n\")), mdx(\"p\", null, \"\\u67E5\\u770B\\u662F\\u5426\\u5B89\\u88C5\\u5B8C\\u6210\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"sudo modprobe wireguard | lsmod | grep wireguard\\n\")), mdx(\"p\", null, \"\\u5728 \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"/etc/moduels\"), \" \\u540E\\u8FFD\\u52A0 \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"wireguard\"), \" \\u4F7F\\u5F97\\u80FD\\u591F\\u81EA\\u52A8\\u8F7D\\u5165\\u5185\\u6838\\u6A21\\u5757\"), mdx(\"h2\", {\n    \"id\": \"config\"\n  }, \"Config\"), mdx(\"h3\", {\n    \"id\": \"生成公私钥\"\n  }, \"\\u751F\\u6210\\u516C\\u79C1\\u94A5\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-shell\"\n  }, \"wg genkey | tee private | wg pubkey > public\\n\")), mdx(\"h3\", {\n    \"id\": \"peer-1\"\n  }, \"Peer 1\"), mdx(\"p\", null, \"\\u8FD9\\u4E2A\\u4F5C\\u4E3A\\u63A5\\u53D7\\u5916\\u6765\\u8FDE\\u63A5\\u7684\\u5BF9\\u7B49\\u7AEF\"), mdx(\"p\", null, \"\\u7F16\\u8F91 \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"/etc/wireguard/wg0.conf\"), \"\\uFF0C\\u6DFB\\u52A0\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-conf\"\n  }, \"[Interface]\\nAddress = 10.1.1.1/24 # \\u5BF9\\u7B49\\u7AEF\\u7684 IP\\nListenPort = 48659 # \\u76D1\\u542C\\u7684\\u7AEF\\u53E3\\nPrivateKey = Private Key 1\\n\\n[Peer] # \\u53D1\\u8D77\\u8FDE\\u63A5\\u5230\\u8FD9\\u4E2A\\u5BA2\\u6237\\u7AEF\\u7684\\u5BF9\\u7AEF\\nPublicKey = Public key 2\\nAllowedIPs = 10.1.1.2/32\\nPersistentKeepalive = 15\\n\")), mdx(\"h3\", {\n    \"id\": \"peer-2\"\n  }, \"Peer 2\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-conf\"\n  }, \"[Interface]\\nPrivateKey = Private Key 2\\nAddress = 10.1.1.2/24 # \\u53D1\\u8D77\\u8FDE\\u63A5\\u7684\\u5BA2\\u6237\\u7AEF\\u7684\\u5730\\u5740\\n\\n[Peer]\\nPublicKey = Public Key 1\\nAllowedIPs = 10.1.1.0/24 # \\u5728\\u672C\\u5730\\u6709\\u54EA\\u4E9B IP \\u5730\\u5740\\u9700\\u8981\\u8D70 wg \\u7684\\u7AEF\\u53E3\\u51FA\\u53BB\\nEndpoint = ip1:port\\nPersistentKeepalive = 15\\n\")), mdx(\"h2\", {\n    \"id\": \"route\"\n  }, \"Route\"), mdx(\"blockquote\", null, mdx(\"p\", {\n    parentName: \"blockquote\"\n  }, \"\\u53C2\\u8003\\u4E86 \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://gobomb.github.io/post/wireguard-notes/\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }, \"Wireguard \\u4F7F\\u7528\\u7B14\\u8BB0\"))), mdx(\"h3\", {\n    \"id\": \"forward\"\n  }, \"Forward\"), mdx(\"p\", null, \"\\u9700\\u8981\\u4FEE\\u6539 \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"/etc/sysctl.conf\")), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-conf\"\n  }, \"net.ipv4.ip_forward = 1\\n\")), mdx(\"p\", null, \"\\u4F7F\\u5F97\\u5141\\u8BB8\\u5185\\u6838\\u8F6C\\u53D1\"), mdx(\"h3\", {\n    \"id\": \"iptables\"\n  }, \"iptables\"), mdx(\"p\", null, \"\\u73B0\\u5728\\u5E94\\u8BE5\\u5DF2\\u7ECF\\u53EF\\u4EE5\\u8BBF\\u95EE WireGuard \\u7684\\u5185\\u7F51\\u4E2D\\u7684\\u5176\\u4ED6\\u8BBE\\u5907\\u4E86\\uFF0C\\u4F46\\u662F\\u65E0\\u6CD5\\u901A\\u8FC7\\u53E6\\u4E00\\u4E2A\\u8BBE\\u5907\\u5C06\\u5305\\u8F6C\\u53D1\\u51FA\\u53BB\"), mdx(\"p\", null, \"\\u6DFB\\u52A0 iptables \\u7684 filter \\u8868\\u4E2D FORWARD \\u94FE\\u7684\\u89C4\\u5219\\uFF0C\\u5141\\u8BB8\\u6765\\u81EA wg0 \\u548C\\u53D1\\u5F80 wg0 \\u7684\\u5305\\u901A\\u8FC7\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-shell\"\n  }, \"iptables -t filter -A FORWARD -i wg0 -j ACCEPT\\niptables -t filter -A FORWARD -o wg0 -j ACCEPT\\n\")), mdx(\"p\", null, \"\\u5728\\u8FD9\\u4E2A\\u65F6\\u5019\\u5E94\\u8BE5\\u53EF\\u4EE5\\u5728\\u5916\\u9762\\u7684\\u8BBE\\u5907\\u4E0A\\u6536\\u5230\\u4E86\\u8BF7\\u6C42\\uFF0C\\u4F46\\u662F\\u5916\\u9762\\u7684\\u8BBE\\u5907\\u6536\\u5230\\u7684 ip \\u7684\\u6E90\\u5730\\u5740\\u662F\\u5185\\u7F51\\u5730\\u5740\\uFF0C\\n\\u800C\\u5176\\u4E0A\\u9762\\u4E0D\\u4F1A\\u6709\\u5230\\u5185\\u7F51\\u5730\\u5740\\u7684\\u8DEF\\u7531\\uFF0C\\u56E0\\u6B64\\u9700\\u8981\\u901A\\u8FC7 NAT \\u5C06\\u6E90\\u5730\\u5740\\u4FEE\\u6539\\u4E3A\\u51FA\\u53E3\\u7F51\\u5361\\u7684\\u51FA\\u53E3\\u5730\\u5740\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-shell\"\n  }, \"iptables -t nat -A POSTROUTING -s 10.1.1.0/24 -o eth0 -j MASQUERADE\\n\")), mdx(\"p\", null, \"\\u4E4B\\u540E\\u5C31\\u5E94\\u8BE5\\u53EF\\u4EE5\\u6B63\\u5E38\\u5730\\u8BBF\\u95EE\\u4E86\"), mdx(\"h2\", {\n    \"id\": \"config-1\"\n  }, \"Config\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-conf\"\n  }, \"[Interface]\\n    Address = 10.3.1.1/24\\n    ListenPort = 48659\\n    PrivateKey = Pirvate Key 1\\n    PostUp = iptables -t filter -A FORWARD -i %i -j ACCEPT; iptables -t filter -A FORWARD -o %i -j ACCEPT; iptables -t nat -A POSTROUTING -s 10.3.1.0/24 -o wlan0 -j MASQUERADE\\n    PostDown = iptables -t filter -D FORWARD -i %i -j ACCEPT; iptables -t filter -D FORWARD -o %i -j ACCEPT; iptables -t nat -D POSTROUTING -s 10.3.1.0/24 -o wlan0 -j MASQUERADE\\n[Peer]\\n    PublicKey = Public Key 2\\n    AllowedIPs = 10.3.1.2/32\\n    PersistentKeepalive = 15\\n\")), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-conf\"\n  }, \"[Interface]\\nPrivateKey = Private Key 2\\nAddress = 10.3.1.2/24\\n\\n[Peer]\\nPublicKey = Public Key 1\\nAllowedIPs = 10.3.1.0/24\\nEndpoint = ip:port\\nPersistentKeepalive = 15\\n\")));\n}\n;\nMDXContent.isMDXComponent = true;","hero":{"full":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAcVAAAHFQFOI0uTAAABbklEQVQoz5WSX0vCYBTG/TTRRXQdfYi6qU9QH6Zugu66szAq8F9QGAVeJCmoKdhKZxYx2HDNzbnSNtG9T2/vnGyrKR04vNsO++15zrMIAAKn3BOEENbutT0eg9g26+A8WJEgzH3Be/pmHmgYkMyCWoaBt1wOCs/jq9v1QWcpRBDmAk82NpHa2kbj4hKxtXWMLGuuQp9F1hMF6nML+0vLqBweQapWsbewCKFQYDO218CuwxVOgIYo4mBlFbXTM1SiUQZXGg0HOBo5QQXERKaqQiw8JpO43dll0KdUGmErmlr2WWy9oJm5Yv1jTcjn0eGbEO7yzLKp65A5DmK5zGZiqQRDkvwKvV/4aLfRzGbBJVPgr29wHzsGlz6HUCzilSZdz2TwkEigFo+Do2prVL1cr/8CkgmQ2PTs9nqwhkN8DgbQ6G+iaxr0jgpVUdCRZfTp8wFNum+aeKf3lmn9GYoDDdnjvPIG41PoDeg/7YV+A1R9kSCCpwaQAAAAAElFTkSuQmCC","aspectRatio":1.673758865248227,"src":"/static/d1ce1200bd3e7a518aed8d1a5d4c5e04/a1946/wireguard-hero.png","srcSet":"/static/d1ce1200bd3e7a518aed8d1a5d4c5e04/5b37e/wireguard-hero.png 236w,\n/static/d1ce1200bd3e7a518aed8d1a5d4c5e04/49058/wireguard-hero.png 472w,\n/static/d1ce1200bd3e7a518aed8d1a5d4c5e04/a1946/wireguard-hero.png 944w,\n/static/d1ce1200bd3e7a518aed8d1a5d4c5e04/030f1/wireguard-hero.png 1416w,\n/static/d1ce1200bd3e7a518aed8d1a5d4c5e04/c1b57/wireguard-hero.png 1809w","srcWebp":"/static/d1ce1200bd3e7a518aed8d1a5d4c5e04/99fbb/wireguard-hero.webp","srcSetWebp":"/static/d1ce1200bd3e7a518aed8d1a5d4c5e04/77392/wireguard-hero.webp 236w,\n/static/d1ce1200bd3e7a518aed8d1a5d4c5e04/1f177/wireguard-hero.webp 472w,\n/static/d1ce1200bd3e7a518aed8d1a5d4c5e04/99fbb/wireguard-hero.webp 944w,\n/static/d1ce1200bd3e7a518aed8d1a5d4c5e04/4a492/wireguard-hero.webp 1416w,\n/static/d1ce1200bd3e7a518aed8d1a5d4c5e04/53944/wireguard-hero.webp 1809w","sizes":"(max-width: 944px) 100vw, 944px"},"regular":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAcVAAAHFQFOI0uTAAABbklEQVQoz5WSX0vCYBTG/TTRRXQdfYi6qU9QH6Zugu66szAq8F9QGAVeJCmoKdhKZxYx2HDNzbnSNtG9T2/vnGyrKR04vNsO++15zrMIAAKn3BOEENbutT0eg9g26+A8WJEgzH3Be/pmHmgYkMyCWoaBt1wOCs/jq9v1QWcpRBDmAk82NpHa2kbj4hKxtXWMLGuuQp9F1hMF6nML+0vLqBweQapWsbewCKFQYDO218CuwxVOgIYo4mBlFbXTM1SiUQZXGg0HOBo5QQXERKaqQiw8JpO43dll0KdUGmErmlr2WWy9oJm5Yv1jTcjn0eGbEO7yzLKp65A5DmK5zGZiqQRDkvwKvV/4aLfRzGbBJVPgr29wHzsGlz6HUCzilSZdz2TwkEigFo+Do2prVL1cr/8CkgmQ2PTs9nqwhkN8DgbQ6G+iaxr0jgpVUdCRZfTp8wFNum+aeKf3lmn9GYoDDdnjvPIG41PoDeg/7YV+A1R9kSCCpwaQAAAAAElFTkSuQmCC","aspectRatio":1.6804123711340206,"src":"/static/d1ce1200bd3e7a518aed8d1a5d4c5e04/3ddd4/wireguard-hero.png","srcSet":"/static/d1ce1200bd3e7a518aed8d1a5d4c5e04/078a8/wireguard-hero.png 163w,\n/static/d1ce1200bd3e7a518aed8d1a5d4c5e04/e56da/wireguard-hero.png 327w,\n/static/d1ce1200bd3e7a518aed8d1a5d4c5e04/3ddd4/wireguard-hero.png 653w,\n/static/d1ce1200bd3e7a518aed8d1a5d4c5e04/c5cc7/wireguard-hero.png 980w,\n/static/d1ce1200bd3e7a518aed8d1a5d4c5e04/eebd2/wireguard-hero.png 1306w,\n/static/d1ce1200bd3e7a518aed8d1a5d4c5e04/c1b57/wireguard-hero.png 1809w","srcWebp":"/static/d1ce1200bd3e7a518aed8d1a5d4c5e04/0acdf/wireguard-hero.webp","srcSetWebp":"/static/d1ce1200bd3e7a518aed8d1a5d4c5e04/ac59e/wireguard-hero.webp 163w,\n/static/d1ce1200bd3e7a518aed8d1a5d4c5e04/7660b/wireguard-hero.webp 327w,\n/static/d1ce1200bd3e7a518aed8d1a5d4c5e04/0acdf/wireguard-hero.webp 653w,\n/static/d1ce1200bd3e7a518aed8d1a5d4c5e04/75470/wireguard-hero.webp 980w,\n/static/d1ce1200bd3e7a518aed8d1a5d4c5e04/68d47/wireguard-hero.webp 1306w,\n/static/d1ce1200bd3e7a518aed8d1a5d4c5e04/53944/wireguard-hero.webp 1809w","sizes":"(max-width: 653px) 100vw, 653px"},"narrow":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAcVAAAHFQFOI0uTAAABbklEQVQoz5WSX0vCYBTG/TTRRXQdfYi6qU9QH6Zugu66szAq8F9QGAVeJCmoKdhKZxYx2HDNzbnSNtG9T2/vnGyrKR04vNsO++15zrMIAAKn3BOEENbutT0eg9g26+A8WJEgzH3Be/pmHmgYkMyCWoaBt1wOCs/jq9v1QWcpRBDmAk82NpHa2kbj4hKxtXWMLGuuQp9F1hMF6nML+0vLqBweQapWsbewCKFQYDO218CuwxVOgIYo4mBlFbXTM1SiUQZXGg0HOBo5QQXERKaqQiw8JpO43dll0KdUGmErmlr2WWy9oJm5Yv1jTcjn0eGbEO7yzLKp65A5DmK5zGZiqQRDkvwKvV/4aLfRzGbBJVPgr29wHzsGlz6HUCzilSZdz2TwkEigFo+Do2prVL1cr/8CkgmQ2PTs9nqwhkN8DgbQ6G+iaxr0jgpVUdCRZfTp8wFNum+aeKf3lmn9GYoDDdnjvPIG41PoDeg/7YV+A1R9kSCCpwaQAAAAAElFTkSuQmCC","aspectRatio":1.6764705882352942,"src":"/static/d1ce1200bd3e7a518aed8d1a5d4c5e04/502b1/wireguard-hero.png","srcSet":"/static/d1ce1200bd3e7a518aed8d1a5d4c5e04/f2e6d/wireguard-hero.png 114w,\n/static/d1ce1200bd3e7a518aed8d1a5d4c5e04/4ddba/wireguard-hero.png 229w,\n/static/d1ce1200bd3e7a518aed8d1a5d4c5e04/502b1/wireguard-hero.png 457w,\n/static/d1ce1200bd3e7a518aed8d1a5d4c5e04/7ddc2/wireguard-hero.png 686w,\n/static/d1ce1200bd3e7a518aed8d1a5d4c5e04/435bf/wireguard-hero.png 914w,\n/static/d1ce1200bd3e7a518aed8d1a5d4c5e04/c1b57/wireguard-hero.png 1809w","srcWebp":"/static/d1ce1200bd3e7a518aed8d1a5d4c5e04/15384/wireguard-hero.webp","srcSetWebp":"/static/d1ce1200bd3e7a518aed8d1a5d4c5e04/31fce/wireguard-hero.webp 114w,\n/static/d1ce1200bd3e7a518aed8d1a5d4c5e04/e3e25/wireguard-hero.webp 229w,\n/static/d1ce1200bd3e7a518aed8d1a5d4c5e04/15384/wireguard-hero.webp 457w,\n/static/d1ce1200bd3e7a518aed8d1a5d4c5e04/0258d/wireguard-hero.webp 686w,\n/static/d1ce1200bd3e7a518aed8d1a5d4c5e04/64ea2/wireguard-hero.webp 914w,\n/static/d1ce1200bd3e7a518aed8d1a5d4c5e04/53944/wireguard-hero.webp 1809w","sizes":"(max-width: 457px) 100vw, 457px"},"seo":{"src":"/static/d1ce1200bd3e7a518aed8d1a5d4c5e04/6050d/wireguard-hero.png"}}},"authors":[{"authorsPage":false,"bio":"Undergraduate of Information Security in USTC","id":"2785af8d-2c14-5bba-9b27-899152fefb53","name":"Elsa Granger","featured":true,"social":[{"url":"https://github.com/zeyugao"}],"slug":"/authors/elsa-granger","avatar":{"small":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAGQABAAMBAQAAAAAAAAAAAAAAAAECAwQF/8QAFgEBAQEAAAAAAAAAAAAAAAAAAQAC/9oADAMBAAIQAxAAAAH2qUqa6EIzgbQF/8QAGxAAAgEFAAAAAAAAAAAAAAAAATEAAgMQESH/2gAIAQEAAQUCzcWuhVMwL//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQMBAT8BH//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQIBAT8BH//EABkQAAEFAAAAAAAAAAAAAAAAAAACEBEgYf/aAAgBAQAGPwJ4E5X/xAAaEAEBAAMBAQAAAAAAAAAAAAABABEhMRBB/9oACAEBAAE/IWF++bLDIxvYTg3cJR6uV//aAAwDAQACAAMAAAAQcC8+/8QAFhEBAQEAAAAAAAAAAAAAAAAAASAh/9oACAEDAQE/EAyP/8QAFhEBAQEAAAAAAAAAAAAAAAAAEAFB/9oACAECAQE/EKYf/8QAHRABAAMBAAIDAAAAAAAAAAAAAQARMSFBUWFxof/aAAgBAQABPxBUPaouZULVjezS4HmDSe+5CC1dWKTPn7n4IwKc6RK98sasz//Z","aspectRatio":1,"src":"/static/12eeb4f9f55bb6f929bc3e016a45737b/fa1ea/elsagranger-head.jpg","srcSet":"/static/12eeb4f9f55bb6f929bc3e016a45737b/afb2b/elsagranger-head.jpg 13w,\n/static/12eeb4f9f55bb6f929bc3e016a45737b/7c20e/elsagranger-head.jpg 25w,\n/static/12eeb4f9f55bb6f929bc3e016a45737b/fa1ea/elsagranger-head.jpg 50w,\n/static/12eeb4f9f55bb6f929bc3e016a45737b/03612/elsagranger-head.jpg 75w,\n/static/12eeb4f9f55bb6f929bc3e016a45737b/61cdf/elsagranger-head.jpg 100w,\n/static/12eeb4f9f55bb6f929bc3e016a45737b/88b18/elsagranger-head.jpg 300w","srcWebp":"/static/12eeb4f9f55bb6f929bc3e016a45737b/e7b2c/elsagranger-head.webp","srcSetWebp":"/static/12eeb4f9f55bb6f929bc3e016a45737b/58718/elsagranger-head.webp 13w,\n/static/12eeb4f9f55bb6f929bc3e016a45737b/74aad/elsagranger-head.webp 25w,\n/static/12eeb4f9f55bb6f929bc3e016a45737b/e7b2c/elsagranger-head.webp 50w,\n/static/12eeb4f9f55bb6f929bc3e016a45737b/ed320/elsagranger-head.webp 75w,\n/static/12eeb4f9f55bb6f929bc3e016a45737b/66016/elsagranger-head.webp 100w,\n/static/12eeb4f9f55bb6f929bc3e016a45737b/0bc1d/elsagranger-head.webp 300w","sizes":"(max-width: 50px) 100vw, 50px"},"medium":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAGQABAAMBAQAAAAAAAAAAAAAAAAECAwQF/8QAFgEBAQEAAAAAAAAAAAAAAAAAAQAC/9oADAMBAAIQAxAAAAH2qUqa6EIzgbQF/8QAGxAAAgEFAAAAAAAAAAAAAAAAATEAAgMQESH/2gAIAQEAAQUCzcWuhVMwL//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQMBAT8BH//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQIBAT8BH//EABkQAAEFAAAAAAAAAAAAAAAAAAACEBEgYf/aAAgBAQAGPwJ4E5X/xAAaEAEBAAMBAQAAAAAAAAAAAAABABEhMRBB/9oACAEBAAE/IWF++bLDIxvYTg3cJR6uV//aAAwDAQACAAMAAAAQcC8+/8QAFhEBAQEAAAAAAAAAAAAAAAAAASAh/9oACAEDAQE/EAyP/8QAFhEBAQEAAAAAAAAAAAAAAAAAEAFB/9oACAECAQE/EKYf/8QAHRABAAMBAAIDAAAAAAAAAAAAAQARMSFBUWFxof/aAAgBAQABPxBUPaouZULVjezS4HmDSe+5CC1dWKTPn7n4IwKc6RK98sasz//Z","aspectRatio":1,"src":"/static/12eeb4f9f55bb6f929bc3e016a45737b/61cdf/elsagranger-head.jpg","srcSet":"/static/12eeb4f9f55bb6f929bc3e016a45737b/7c20e/elsagranger-head.jpg 25w,\n/static/12eeb4f9f55bb6f929bc3e016a45737b/fa1ea/elsagranger-head.jpg 50w,\n/static/12eeb4f9f55bb6f929bc3e016a45737b/61cdf/elsagranger-head.jpg 100w,\n/static/12eeb4f9f55bb6f929bc3e016a45737b/59538/elsagranger-head.jpg 150w,\n/static/12eeb4f9f55bb6f929bc3e016a45737b/fd013/elsagranger-head.jpg 200w,\n/static/12eeb4f9f55bb6f929bc3e016a45737b/88b18/elsagranger-head.jpg 300w","srcWebp":"/static/12eeb4f9f55bb6f929bc3e016a45737b/66016/elsagranger-head.webp","srcSetWebp":"/static/12eeb4f9f55bb6f929bc3e016a45737b/74aad/elsagranger-head.webp 25w,\n/static/12eeb4f9f55bb6f929bc3e016a45737b/e7b2c/elsagranger-head.webp 50w,\n/static/12eeb4f9f55bb6f929bc3e016a45737b/66016/elsagranger-head.webp 100w,\n/static/12eeb4f9f55bb6f929bc3e016a45737b/d9b14/elsagranger-head.webp 150w,\n/static/12eeb4f9f55bb6f929bc3e016a45737b/6b183/elsagranger-head.webp 200w,\n/static/12eeb4f9f55bb6f929bc3e016a45737b/0bc1d/elsagranger-head.webp 300w","sizes":"(max-width: 100px) 100vw, 100px"},"large":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAGQABAAMBAQAAAAAAAAAAAAAAAAECAwQF/8QAFgEBAQEAAAAAAAAAAAAAAAAAAQAC/9oADAMBAAIQAxAAAAH2qUqa6EIzgbQF/8QAGxAAAgEFAAAAAAAAAAAAAAAAATEAAgMQESH/2gAIAQEAAQUCzcWuhVMwL//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQMBAT8BH//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQIBAT8BH//EABkQAAEFAAAAAAAAAAAAAAAAAAACEBEgYf/aAAgBAQAGPwJ4E5X/xAAaEAEBAAMBAQAAAAAAAAAAAAABABEhMRBB/9oACAEBAAE/IWF++bLDIxvYTg3cJR6uV//aAAwDAQACAAMAAAAQcC8+/8QAFhEBAQEAAAAAAAAAAAAAAAAAASAh/9oACAEDAQE/EAyP/8QAFhEBAQEAAAAAAAAAAAAAAAAAEAFB/9oACAECAQE/EKYf/8QAHRABAAMBAAIDAAAAAAAAAAAAAQARMSFBUWFxof/aAAgBAQABPxBUPaouZULVjezS4HmDSe+5CC1dWKTPn7n4IwKc6RK98sasz//Z","aspectRatio":1,"src":"/static/12eeb4f9f55bb6f929bc3e016a45737b/88b18/elsagranger-head.jpg","srcSet":"/static/12eeb4f9f55bb6f929bc3e016a45737b/a2637/elsagranger-head.jpg 82w,\n/static/12eeb4f9f55bb6f929bc3e016a45737b/15203/elsagranger-head.jpg 164w,\n/static/12eeb4f9f55bb6f929bc3e016a45737b/88b18/elsagranger-head.jpg 300w","srcWebp":"/static/12eeb4f9f55bb6f929bc3e016a45737b/0bc1d/elsagranger-head.webp","srcSetWebp":"/static/12eeb4f9f55bb6f929bc3e016a45737b/2d087/elsagranger-head.webp 82w,\n/static/12eeb4f9f55bb6f929bc3e016a45737b/29d87/elsagranger-head.webp 164w,\n/static/12eeb4f9f55bb6f929bc3e016a45737b/0bc1d/elsagranger-head.webp 300w","sizes":"(max-width: 300px) 100vw, 300px"}}}],"basePath":"/","permalink":"https://blog.elsagranger.com/wireguard/","slug":"/wireguard","id":"930818d7-5a80-5fce-ad59-d9fab7b64895","title":"WireGuard 配置","canonicalUrl":null,"mailchimp":"","next":[{"id":"195b53ee-ddf0-5534-9062-76c0a5839b4d","slug":"/time-machine-server-on-linux","secret":false,"title":"Time Machine Server on Linux","author":"Elsa Granger","date":"November 21st, 2020","dateForSEO":"2020-11-21T00:00:00.000Z","timeToRead":1,"excerpt":"将 Linux 作为 Time Machine 的服务器，提供备份服务","canonical_url":null,"subscription":true,"body":"function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"Time Machine Server on Linux\",\n  \"author\": \"Elsa Granger\",\n  \"hero\": \"./images/time-machine-hero.png\",\n  \"date\": \"2020-11-21T00:00:00.000Z\",\n  \"excerpt\": \"将 Linux 作为 Time Machine 的服务器，提供备份服务\"\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, [\"components\"]);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"\\u5728 Linux \\u4E0A\\u914D\\u7F6E\\u4E86 Samba \\u4E4B\\u540E\\uFF0C\\u5E76\\u4E0D\\u80FD\\u5B57\\u8282\\u7528\\u6765\\u4F5C\\u4E3A Time Machine \\u7684\\u5907\\u4EFD\\u5206\\u533A\\uFF0C\\u5728 Finder \\u7684 Network \\u4E0B\\uFF0C\\u76F4\\u63A5\\u5C1D\\u8BD5 Connect As \\u5E76\\u4E0D\\u80FD\\u591F\\u8FDE\\u4E0A\\u670D\\u52A1\\u5668\\uFF0C\\u53EA\\u80FD\\u901A\\u8FC7 \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"cmd + k\"), \" \\u8FDE\\u63A5\\u4E0A\\u53BB\\u3002\\u90FD\\u662F\\u7528\\u4E8E\\u6CA1\\u6709\\u914D\\u7F6E afp \\u534F\\u8BAE\\u3002\"), mdx(\"h2\", {\n    \"id\": \"installation\"\n  }, \"Installation\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-shell\"\n  }, \"apt install netatalk avahi-daemon\\n\")), mdx(\"h2\", {\n    \"id\": \"configure\"\n  }, \"Configure\"), mdx(\"h3\", {\n    \"id\": \"netatalk\"\n  }, \"netatalk\"), mdx(\"p\", null, \"\\u4F4D\\u7F6E \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"/etc/netatalk/afp.conf\")), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-conf\"\n  }, \"[Global]\\n dbus daemon = /usr/bin/dbus-daemon\\n disconnect time = 3\\n sleep time = 2\\n log file = /var/log/netatalk.log\\n log level = default:info\\n uam list = uams_dhx2.so\\n zeroconf = yes\\n save password = no\\n\\n\\n[SharedFolder]\\n path = 'shared folder path'\\n ; http://netatalk.sourceforge.net/wiki/index.php/Spotlight\\n ; spotlight = yes\\n valid users = USERNAME1 USERNAME2 USERNAME3\\n unix priv = yes\\n file perm = 0600\\n\\n[TimeCapsule]\\npath = 'time machine folder'\\nvalid users = USERNAME2\\ntime machine = yes\\nunix priv = yes\\nfile perm = 0600\\n\")), mdx(\"h3\", {\n    \"id\": \"avahi\"\n  }, \"avahi\"), mdx(\"p\", null, \"\\u6DFB\\u52A0 afp \\u534F\\u8BAE\"), mdx(\"p\", null, \"\\u4F4D\\u7F6E \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"/etc/avahi/services/timecapsule_afpd.service\")), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-xml\"\n  }, \"<?xml version=\\\"1.0\\\" standalone='no'?>\\n<!DOCTYPE service-group SYSTEM \\\"avahi-service.dtd\\\">\\n<service-group>\\n <name replace-wildcards=\\\"yes\\\">%h</name>\\n <service>\\n <type>_afpovertcp._tcp</type>\\n <port>548</port>\\n </service>\\n <service>\\n <type>_device-info._tcp</type>\\n <port>0</port>\\n <txt-record>model=TimeCapsule</txt-record>\\n </service>\\n</service-group>\\n\")));\n}\n;\nMDXContent.isMDXComponent = true;","hero":{"full":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAAB8klEQVQoz52T30sUURTH5++oJx8jiKjHYtFdaxYsIlL7YbVpJrX51kNUYIVgSyKIrbhJDxqB1lJirWzZ9hBRDy1lW2CsM2Okm23Q6sO2QTszfZqZnVlnbYnqC9+5Zy73fO+5536v8LMEDFijm7qu/5F2Ho6G+RGgPMf/wJVnBYK7QnPXoqqiahqFQoE5STIoI8mKQRnZpqLIzKXT5HK53yt0jmfiR7GIbtDETPIl7Xv3cKatjY5DAToOt9LacoLG5pPsbjyFxx+gr/+6tVbT9HKbBEdMt8fZzCLx97NMJaYJnT3HzeFR4pMx4lOPuT/5iFgsQWT4NsHgRYYiI6VcfY2gOWFCymRoGgrji4TZP3iNy13nuXNjgMzCR6T0C75+mUdVi7xNpWjed5TBcKS6oGb0zEQ08YRNnZ1svtSF2N3DhXaR2NXTrCwvM/P8Fp8XXlnr3qXesLGmhlDPFfvIWvUKF5eW8BwJsKXpAP5jxzlYt5XuYAsPJ6JMP5jg3t0or5NJxkZH2LB+HX2hVUHnxld7aItms1kST58xPjZO3fZt7BJFGnxeGnbUI3q97Kytxe+rx+/xMNDby7fC9wrvVtyyaljGwSejWtMqJcsoFRaSFcWKlfkP5PP5cnWWoPvHifV/NLn7UQhrxf722VV5fhZ/Acv9Um+kxN46AAAAAElFTkSuQmCC","aspectRatio":1.6978417266187051,"src":"/static/2178291e69ce3b874297ee3f7c34b732/a1946/time-machine-hero.png","srcSet":"/static/2178291e69ce3b874297ee3f7c34b732/5b37e/time-machine-hero.png 236w,\n/static/2178291e69ce3b874297ee3f7c34b732/49058/time-machine-hero.png 472w,\n/static/2178291e69ce3b874297ee3f7c34b732/a1946/time-machine-hero.png 944w,\n/static/2178291e69ce3b874297ee3f7c34b732/030f1/time-machine-hero.png 1416w,\n/static/2178291e69ce3b874297ee3f7c34b732/69278/time-machine-hero.png 1800w","srcWebp":"/static/2178291e69ce3b874297ee3f7c34b732/99fbb/time-machine-hero.webp","srcSetWebp":"/static/2178291e69ce3b874297ee3f7c34b732/77392/time-machine-hero.webp 236w,\n/static/2178291e69ce3b874297ee3f7c34b732/1f177/time-machine-hero.webp 472w,\n/static/2178291e69ce3b874297ee3f7c34b732/99fbb/time-machine-hero.webp 944w,\n/static/2178291e69ce3b874297ee3f7c34b732/4a492/time-machine-hero.webp 1416w,\n/static/2178291e69ce3b874297ee3f7c34b732/60b4e/time-machine-hero.webp 1800w","sizes":"(max-width: 944px) 100vw, 944px"},"regular":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAAB8klEQVQoz52T30sUURTH5++oJx8jiKjHYtFdaxYsIlL7YbVpJrX51kNUYIVgSyKIrbhJDxqB1lJirWzZ9hBRDy1lW2CsM2Okm23Q6sO2QTszfZqZnVlnbYnqC9+5Zy73fO+5536v8LMEDFijm7qu/5F2Ho6G+RGgPMf/wJVnBYK7QnPXoqqiahqFQoE5STIoI8mKQRnZpqLIzKXT5HK53yt0jmfiR7GIbtDETPIl7Xv3cKatjY5DAToOt9LacoLG5pPsbjyFxx+gr/+6tVbT9HKbBEdMt8fZzCLx97NMJaYJnT3HzeFR4pMx4lOPuT/5iFgsQWT4NsHgRYYiI6VcfY2gOWFCymRoGgrji4TZP3iNy13nuXNjgMzCR6T0C75+mUdVi7xNpWjed5TBcKS6oGb0zEQ08YRNnZ1svtSF2N3DhXaR2NXTrCwvM/P8Fp8XXlnr3qXesLGmhlDPFfvIWvUKF5eW8BwJsKXpAP5jxzlYt5XuYAsPJ6JMP5jg3t0or5NJxkZH2LB+HX2hVUHnxld7aItms1kST58xPjZO3fZt7BJFGnxeGnbUI3q97Kytxe+rx+/xMNDby7fC9wrvVtyyaljGwSejWtMqJcsoFRaSFcWKlfkP5PP5cnWWoPvHifV/NLn7UQhrxf722VV5fhZ/Acv9Um+kxN46AAAAAElFTkSuQmCC","aspectRatio":1.6979166666666667,"src":"/static/2178291e69ce3b874297ee3f7c34b732/3ddd4/time-machine-hero.png","srcSet":"/static/2178291e69ce3b874297ee3f7c34b732/078a8/time-machine-hero.png 163w,\n/static/2178291e69ce3b874297ee3f7c34b732/e56da/time-machine-hero.png 327w,\n/static/2178291e69ce3b874297ee3f7c34b732/3ddd4/time-machine-hero.png 653w,\n/static/2178291e69ce3b874297ee3f7c34b732/c5cc7/time-machine-hero.png 980w,\n/static/2178291e69ce3b874297ee3f7c34b732/eebd2/time-machine-hero.png 1306w,\n/static/2178291e69ce3b874297ee3f7c34b732/69278/time-machine-hero.png 1800w","srcWebp":"/static/2178291e69ce3b874297ee3f7c34b732/0acdf/time-machine-hero.webp","srcSetWebp":"/static/2178291e69ce3b874297ee3f7c34b732/ac59e/time-machine-hero.webp 163w,\n/static/2178291e69ce3b874297ee3f7c34b732/7660b/time-machine-hero.webp 327w,\n/static/2178291e69ce3b874297ee3f7c34b732/0acdf/time-machine-hero.webp 653w,\n/static/2178291e69ce3b874297ee3f7c34b732/75470/time-machine-hero.webp 980w,\n/static/2178291e69ce3b874297ee3f7c34b732/68d47/time-machine-hero.webp 1306w,\n/static/2178291e69ce3b874297ee3f7c34b732/60b4e/time-machine-hero.webp 1800w","sizes":"(max-width: 653px) 100vw, 653px"},"narrow":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAAB8klEQVQoz52T30sUURTH5++oJx8jiKjHYtFdaxYsIlL7YbVpJrX51kNUYIVgSyKIrbhJDxqB1lJirWzZ9hBRDy1lW2CsM2Okm23Q6sO2QTszfZqZnVlnbYnqC9+5Zy73fO+5536v8LMEDFijm7qu/5F2Ho6G+RGgPMf/wJVnBYK7QnPXoqqiahqFQoE5STIoI8mKQRnZpqLIzKXT5HK53yt0jmfiR7GIbtDETPIl7Xv3cKatjY5DAToOt9LacoLG5pPsbjyFxx+gr/+6tVbT9HKbBEdMt8fZzCLx97NMJaYJnT3HzeFR4pMx4lOPuT/5iFgsQWT4NsHgRYYiI6VcfY2gOWFCymRoGgrji4TZP3iNy13nuXNjgMzCR6T0C75+mUdVi7xNpWjed5TBcKS6oGb0zEQ08YRNnZ1svtSF2N3DhXaR2NXTrCwvM/P8Fp8XXlnr3qXesLGmhlDPFfvIWvUKF5eW8BwJsKXpAP5jxzlYt5XuYAsPJ6JMP5jg3t0or5NJxkZH2LB+HX2hVUHnxld7aItms1kST58xPjZO3fZt7BJFGnxeGnbUI3q97Kytxe+rx+/xMNDby7fC9wrvVtyyaljGwSejWtMqJcsoFRaSFcWKlfkP5PP5cnWWoPvHifV/NLn7UQhrxf722VV5fhZ/Acv9Um+kxN46AAAAAElFTkSuQmCC","aspectRatio":1.7014925373134329,"src":"/static/2178291e69ce3b874297ee3f7c34b732/502b1/time-machine-hero.png","srcSet":"/static/2178291e69ce3b874297ee3f7c34b732/f2e6d/time-machine-hero.png 114w,\n/static/2178291e69ce3b874297ee3f7c34b732/4ddba/time-machine-hero.png 229w,\n/static/2178291e69ce3b874297ee3f7c34b732/502b1/time-machine-hero.png 457w,\n/static/2178291e69ce3b874297ee3f7c34b732/7ddc2/time-machine-hero.png 686w,\n/static/2178291e69ce3b874297ee3f7c34b732/435bf/time-machine-hero.png 914w,\n/static/2178291e69ce3b874297ee3f7c34b732/69278/time-machine-hero.png 1800w","srcWebp":"/static/2178291e69ce3b874297ee3f7c34b732/15384/time-machine-hero.webp","srcSetWebp":"/static/2178291e69ce3b874297ee3f7c34b732/31fce/time-machine-hero.webp 114w,\n/static/2178291e69ce3b874297ee3f7c34b732/e3e25/time-machine-hero.webp 229w,\n/static/2178291e69ce3b874297ee3f7c34b732/15384/time-machine-hero.webp 457w,\n/static/2178291e69ce3b874297ee3f7c34b732/0258d/time-machine-hero.webp 686w,\n/static/2178291e69ce3b874297ee3f7c34b732/64ea2/time-machine-hero.webp 914w,\n/static/2178291e69ce3b874297ee3f7c34b732/60b4e/time-machine-hero.webp 1800w","sizes":"(max-width: 457px) 100vw, 457px"},"seo":{"src":"/static/2178291e69ce3b874297ee3f7c34b732/6050d/time-machine-hero.png"}}},{"id":"b08fa2f2-6caf-5350-9d90-f6755ed587e2","slug":"/influxdb-telegraf-grafana","secret":false,"title":"InfluxDB Telegraf Grafana 配置","author":"Elsa Granger","date":"November 7th, 2020","dateForSEO":"2020-11-07T00:00:00.000Z","timeToRead":1,"excerpt":"使用 InfluxDb Telegraf Grafana 来进行监控，提供了安装过程中需要的一些配置","canonical_url":null,"subscription":true,"body":"function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"InfluxDB Telegraf Grafana 配置\",\n  \"author\": \"Elsa Granger\",\n  \"hero\": \"./images/grafana-hero.png\",\n  \"date\": \"2020-11-07T00:00:00.000Z\",\n  \"excerpt\": \"使用 InfluxDb Telegraf Grafana 来进行监控，提供了安装过程中需要的一些配置\"\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, [\"components\"]);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"h2\", {\n    \"id\": \"installation\"\n  }, \"Installation\"), mdx(\"h3\", {\n    \"id\": \"influxdb-and-telegraf\"\n  }, \"InfluxDB and Telegraf\"), mdx(\"blockquote\", null, mdx(\"p\", {\n    parentName: \"blockquote\"\n  }, \"\\u5B89\\u88C5\\u7684\\u662F 1.x \\u7248\\u672C\\uFF0C\\u5E76\\u4E0D\\u662F 2 \\u7684 beta \\u7248\")), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-shell\"\n  }, \"wget -qO- https://repos.influxdata.com/influxdb.key | sudo apt-key add -\\necho \\\"deb https://repos.influxdata.com/ubuntu ${lsb_release -cs} stable\\\" | sudo tee /etc/apt/sources.list.d/influxdb.list\\n\\nsudo apt-get update && sudo apt-get install telegraf influxdb\\n\")), mdx(\"h3\", {\n    \"id\": \"grafana\"\n  }, \"Grafana\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-shell\"\n  }, \"sudo apt-get install -y apt-transport-https\\nsudo apt-get install -y software-properties-common wget\\nwget -q -O - https://packages.grafana.com/gpg.key | sudo apt-key add -\\necho \\\"deb https://packages.grafana.com/enterprise/deb stable main\\\" | sudo tee -a /etc/apt/sources.list.d/grafana.list\\n\")), mdx(\"h2\", {\n    \"id\": \"configure\"\n  }, \"Configure\"), mdx(\"h3\", {\n    \"id\": \"influxdb\"\n  }, \"InfluxDB\"), mdx(\"h4\", {\n    \"id\": \"创建用户\"\n  }, \"\\u521B\\u5EFA\\u7528\\u6237\"), mdx(\"p\", null, \"\\u4F7F\\u7528 \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"influx\"), \" \\u8FDB\\u5165 influxdb \\u7684\\u4EA4\\u4E92\"), mdx(\"h5\", {\n    \"id\": \"创建-database\"\n  }, \"\\u521B\\u5EFA database\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-sql\"\n  }, \"create database telegraf;\\n\")), mdx(\"h5\", {\n    \"id\": \"创建用户-1\"\n  }, \"\\u521B\\u5EFA\\u7528\\u6237\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-sql\"\n  }, \"create user admin with password 'ROOT PASSWORD' with all privileges;\\ncreate user telegrafuser with password 'PASSWORD HERE';\\n\")), mdx(\"h5\", {\n    \"id\": \"设置权限\"\n  }, \"\\u8BBE\\u7F6E\\u6743\\u9650\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-sql\"\n  }, \"grant all on telegraf to telegrafuser;\\n\")), mdx(\"h4\", {\n    \"id\": \"设置认证\"\n  }, \"\\u8BBE\\u7F6E\\u8BA4\\u8BC1\"), mdx(\"p\", null, mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"/etc/influxdb/influxdb.conf\")), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-conf\"\n  }, \"[http]\\n  # Determines whether HTTP endpoint is enabled.\\n  enabled = true\\n\\n  # The bind address used by the HTTP service.\\n  bind-address = \\\":8086\\\"\\n\\n  # Determines whether user authentication is enabled over HTTP/HTTPS.\\n  auth-enabled = true\\n\")), mdx(\"h3\", {\n    \"id\": \"telegraf\"\n  }, \"Telegraf\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-conf\"\n  }, \"# \\u53BB\\u6389\\u6CE8\\u91CA\\n[[inputs.net]]\\n\\n# \\u6DFB\\u52A0 influxdb \\u4FE1\\u606F\\n[[outputs.influxdb]]\\n    urls = [\\\"http://influxdb-url\\\"]\\n    username = \\\"telegrafuser\\\"\\n    password = \\\"PASSWORD HERE\\\"\\n\")), mdx(\"h3\", {\n    \"id\": \"grafana-1\"\n  }, \"Grafana\"), mdx(\"p\", null, \"\\u5141\\u8BB8\\u533F\\u540D\\u8BBF\\u95EE\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-conf\"\n  }, \"[auth.anonymous]\\n# enable anonymous access\\nenabled = true\\n\")), mdx(\"h2\", {\n    \"id\": \"influxdb-1\"\n  }, \"InfluxDB\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-sql\"\n  }, \"show tag values with key = \\\"host\\\";\\n\")));\n}\n;\nMDXContent.isMDXComponent = true;","hero":{"full":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA2ElEQVQ4y+VTzwuCMBj1/4fOXfsXgk6CiEhlnaSMopM7DNG8hEQL3V6kpps/SqJOffB449v29j4e0wAIFPXkT6rS0L4gpohqv3IIIUSOes3zU3lP2ntXiqDM8iMPcM4VNA20BOUNnpyRneiwWRvO2w5ThmQ6BpvPQI47uJstojAEIQSe5yEIAlBKEUURGGP9DitBluC6GiHdT+AfXCycNRxnCV3XYVkWTNOEYRiwbRtxHA8bWdxOEBe/GJ9nJfMWdwX1MhQ0en3B9QrWF3gJNekudI38Z1/vDrVOTyEc494xAAAAAElFTkSuQmCC","aspectRatio":1.4478527607361964,"src":"/static/e67068bd83b6b904d7ae990d566b2eb5/a6008/grafana-hero.png","srcSet":"/static/e67068bd83b6b904d7ae990d566b2eb5/5b37e/grafana-hero.png 236w,\n/static/e67068bd83b6b904d7ae990d566b2eb5/49058/grafana-hero.png 472w,\n/static/e67068bd83b6b904d7ae990d566b2eb5/a6008/grafana-hero.png 504w","srcWebp":"/static/e67068bd83b6b904d7ae990d566b2eb5/287f5/grafana-hero.webp","srcSetWebp":"/static/e67068bd83b6b904d7ae990d566b2eb5/77392/grafana-hero.webp 236w,\n/static/e67068bd83b6b904d7ae990d566b2eb5/1f177/grafana-hero.webp 472w,\n/static/e67068bd83b6b904d7ae990d566b2eb5/287f5/grafana-hero.webp 504w","sizes":"(max-width: 504px) 100vw, 504px"},"regular":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA2ElEQVQ4y+VTzwuCMBj1/4fOXfsXgk6CiEhlnaSMopM7DNG8hEQL3V6kpps/SqJOffB449v29j4e0wAIFPXkT6rS0L4gpohqv3IIIUSOes3zU3lP2ntXiqDM8iMPcM4VNA20BOUNnpyRneiwWRvO2w5ThmQ6BpvPQI47uJstojAEIQSe5yEIAlBKEUURGGP9DitBluC6GiHdT+AfXCycNRxnCV3XYVkWTNOEYRiwbRtxHA8bWdxOEBe/GJ9nJfMWdwX1MhQ0en3B9QrWF3gJNekudI38Z1/vDrVOTyEc494xAAAAAElFTkSuQmCC","aspectRatio":1.4424778761061947,"src":"/static/e67068bd83b6b904d7ae990d566b2eb5/a6008/grafana-hero.png","srcSet":"/static/e67068bd83b6b904d7ae990d566b2eb5/078a8/grafana-hero.png 163w,\n/static/e67068bd83b6b904d7ae990d566b2eb5/e56da/grafana-hero.png 327w,\n/static/e67068bd83b6b904d7ae990d566b2eb5/a6008/grafana-hero.png 504w","srcWebp":"/static/e67068bd83b6b904d7ae990d566b2eb5/287f5/grafana-hero.webp","srcSetWebp":"/static/e67068bd83b6b904d7ae990d566b2eb5/ac59e/grafana-hero.webp 163w,\n/static/e67068bd83b6b904d7ae990d566b2eb5/7660b/grafana-hero.webp 327w,\n/static/e67068bd83b6b904d7ae990d566b2eb5/287f5/grafana-hero.webp 504w","sizes":"(max-width: 504px) 100vw, 504px"},"narrow":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA2ElEQVQ4y+VTzwuCMBj1/4fOXfsXgk6CiEhlnaSMopM7DNG8hEQL3V6kpps/SqJOffB449v29j4e0wAIFPXkT6rS0L4gpohqv3IIIUSOes3zU3lP2ntXiqDM8iMPcM4VNA20BOUNnpyRneiwWRvO2w5ThmQ6BpvPQI47uJstojAEIQSe5yEIAlBKEUURGGP9DitBluC6GiHdT+AfXCycNRxnCV3XYVkWTNOEYRiwbRtxHA8bWdxOEBe/GJ9nJfMWdwX1MhQ0en3B9QrWF3gJNekudI38Z1/vDrVOTyEc494xAAAAAElFTkSuQmCC","aspectRatio":1.4430379746835442,"src":"/static/e67068bd83b6b904d7ae990d566b2eb5/502b1/grafana-hero.png","srcSet":"/static/e67068bd83b6b904d7ae990d566b2eb5/f2e6d/grafana-hero.png 114w,\n/static/e67068bd83b6b904d7ae990d566b2eb5/4ddba/grafana-hero.png 229w,\n/static/e67068bd83b6b904d7ae990d566b2eb5/502b1/grafana-hero.png 457w,\n/static/e67068bd83b6b904d7ae990d566b2eb5/a6008/grafana-hero.png 504w","srcWebp":"/static/e67068bd83b6b904d7ae990d566b2eb5/15384/grafana-hero.webp","srcSetWebp":"/static/e67068bd83b6b904d7ae990d566b2eb5/31fce/grafana-hero.webp 114w,\n/static/e67068bd83b6b904d7ae990d566b2eb5/e3e25/grafana-hero.webp 229w,\n/static/e67068bd83b6b904d7ae990d566b2eb5/15384/grafana-hero.webp 457w,\n/static/e67068bd83b6b904d7ae990d566b2eb5/287f5/grafana-hero.webp 504w","sizes":"(max-width: 457px) 100vw, 457px"},"seo":{"src":"/static/e67068bd83b6b904d7ae990d566b2eb5/a6008/grafana-hero.png"}}}]}},"staticQueryHashes":["1143375668","1491088328","1921650733","2068910035","2444214635"]}