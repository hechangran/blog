{"componentChunkName":"component---src-templates-page-tsx","path":"/influxdb-telegraf-grafana/","result":{"data":{"site":{"siteMetadata":{"title":"Elsa Granger","description":"Elsa Granger Personal Page","author":{"name":"","url":""}}},"markdownRemark":{"html":"<h2>Installation</h2>\n<h3>InfluxDB and Telegraf</h3>\n<blockquote>\n<p>安装的是 1.x 版本，并不是 2 的 beta 版</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">wget</span> -qO- https://repos.influxdata.com/influxdb.key <span class=\"token operator\">|</span> <span class=\"token function\">sudo</span> apt-key <span class=\"token function\">add</span> -\n<span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"deb https://repos.influxdata.com/ubuntu <span class=\"token variable\">${lsb_release -cs}</span> stable\"</span> <span class=\"token operator\">|</span> <span class=\"token function\">sudo</span> <span class=\"token function\">tee</span> /etc/apt/sources.list.d/influxdb.list\n\n<span class=\"token function\">sudo</span> <span class=\"token function\">apt-get</span> update <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">sudo</span> <span class=\"token function\">apt-get</span> <span class=\"token function\">install</span> telegraf influxdb</code></pre></div>\n<h3>Grafana</h3>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">sudo</span> <span class=\"token function\">apt-get</span> <span class=\"token function\">install</span> -y apt-transport-https\n<span class=\"token function\">sudo</span> <span class=\"token function\">apt-get</span> <span class=\"token function\">install</span> -y software-properties-common <span class=\"token function\">wget</span>\n<span class=\"token function\">wget</span> -q -O - https://packages.grafana.com/gpg.key <span class=\"token operator\">|</span> <span class=\"token function\">sudo</span> apt-key <span class=\"token function\">add</span> -\n<span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"deb https://packages.grafana.com/enterprise/deb stable main\"</span> <span class=\"token operator\">|</span> <span class=\"token function\">sudo</span> <span class=\"token function\">tee</span> -a /etc/apt/sources.list.d/grafana.list </code></pre></div>\n<h2>Configure</h2>\n<h3>InfluxDB</h3>\n<h4>创建用户</h4>\n<p>使用 <code class=\"language-text\">influx</code> 进入 influxdb 的交互</p>\n<h5>创建 database</h5>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">create</span> <span class=\"token keyword\">database</span> telegraf<span class=\"token punctuation\">;</span></code></pre></div>\n<h5>创建用户</h5>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">create</span> <span class=\"token keyword\">user</span> admin <span class=\"token keyword\">with</span> password <span class=\"token string\">'ROOT PASSWORD'</span> <span class=\"token keyword\">with</span> <span class=\"token keyword\">all</span> <span class=\"token keyword\">privileges</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">create</span> <span class=\"token keyword\">user</span> telegrafuser <span class=\"token keyword\">with</span> password <span class=\"token string\">'PASSWORD HERE'</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h5>设置权限</h5>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">grant</span> <span class=\"token keyword\">all</span> <span class=\"token keyword\">on</span> telegraf <span class=\"token keyword\">to</span> telegrafuser<span class=\"token punctuation\">;</span></code></pre></div>\n<h4>设置认证</h4>\n<p><code class=\"language-text\">/etc/influxdb/influxdb.conf</code></p>\n<div class=\"gatsby-highlight\" data-language=\"conf\"><pre class=\"language-conf\"><code class=\"language-conf\">[http]\n  # Determines whether HTTP endpoint is enabled.\n  enabled = true\n\n  # The bind address used by the HTTP service.\n  bind-address = &quot;:8086&quot;\n\n  # Determines whether user authentication is enabled over HTTP/HTTPS.\n  auth-enabled = true</code></pre></div>\n<h3>Telegraf</h3>\n<div class=\"gatsby-highlight\" data-language=\"conf\"><pre class=\"language-conf\"><code class=\"language-conf\"># 去掉注释\n[[inputs.net]]\n\n# 添加 influxdb 信息\n[[outputs.influxdb]]\n    urls = [&quot;http://influxdb-url&quot;]\n    username = &quot;telegrafuser&quot;\n    password = &quot;PASSWORD HERE&quot;</code></pre></div>\n<h3>Grafana</h3>\n<p>允许匿名访问</p>\n<div class=\"gatsby-highlight\" data-language=\"conf\"><pre class=\"language-conf\"><code class=\"language-conf\">[auth.anonymous]\n# enable anonymous access\nenabled = true</code></pre></div>\n<h2>InfluxDB</h2>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">show</span> tag <span class=\"token keyword\">values</span> <span class=\"token keyword\">with</span> <span class=\"token keyword\">key</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"host\"</span><span class=\"token punctuation\">;</span></code></pre></div>","excerpt":"Installation InfluxDB and Telegraf 安装的是 1.x 版本，并不是 2 的 beta 版 Grafana Configure InfluxDB 创建用户 使用  进入 influxdb 的交互 创建 database…","frontmatter":{"title":"InfluxDB Telegraf Grafana 配置"}}},"pageContext":{"slug":"/influxdb-telegraf-grafana/"}},"staticQueryHashes":[]}